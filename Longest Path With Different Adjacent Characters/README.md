Please follow the comments in the code.